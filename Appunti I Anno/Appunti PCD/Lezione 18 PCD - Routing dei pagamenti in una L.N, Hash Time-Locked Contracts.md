# Routing dei pagamenti in una Lightining Network

Nella nota precedente abbiamo visto come sia possibile in Bitcoin implementare dei *canali di pagamento*: due agenti, Alice e Bob, possono collaborativamente inserire nella Blockchain una transazione, la *funding transaction*, con un output spendibile solo da una successiva transazione che sia firmata da entrambi, e allo stesso tempo entrambi gli agenti possono mantenere *off-chain* delle transazioni di ***committment*** con le quali potrebbero spendere unilateralmente l’output della *funding transaction*, se l’altro agente dovesse smettere di collaborare. 

Usando gli opportuni protocolli crittografici, abbiamo visto come sia possibile costruire nuove *committment transactions* e "revocare" le precedenti, in modo che il *bilancio* del canale (quanti btc dell’output della *funding transaction* sono di Alice e quanti sono di Bob) possa essere aggiornato un numero arbitrario di volte, senza inviare nuove transazioni alla rete Bitcoin, dove l’unico limite al valore dei pagamenti è dato dall’ammontare complessivo di btc contenuto nell’output della *funding transaction*.

In questa lezione vediamo come sia possibile implementare un sistema di *routing* di pagamenti all’interno di una "rete di canali": se Alice e Bob hanno un canale di pagamento e Bob e Carol hanno un canale di pagamento, allora Alice può chiedere a Bob di fare da intermediario per il suo pagamento a Carol: Alice pagherà Bob (vale a dire, ci sarà un aggiornamento del bilancio del canale fra Alice e Bob) e Bob pagherà Carol (vale a dire, ci sarà un aggiornamento del canale fra Bob e Carol).

